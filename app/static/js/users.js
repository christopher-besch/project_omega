(()=>{"use strict";class t{constructor(t){let e=document.getElementById(t);this.url=e.getAttribute("url"),this.csrf_token=e.getAttribute("csrf_token")}send(t,e,s=!0){let n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState){try{JSON.parse(n.responseText)}catch(t){return void e("failure",!1)}e(JSON.parse(n.responseText),200===n.status)}},n.open("POST",this.url,s),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("X-CSRFToken",this.csrf_token),n.send(JSON.stringify(t))}}function e(t,e){let s=document.getElementsByClassName(t);for(let t of s)t.addEventListener("click",(s=>{e(t)}))}function s(t,e,s="Loading..."){let n=t.getElementsByClassName("on-loads");for(let t of n)t.style.display=e?"inline-block":"none";e?t.setAttribute("disabled",""):t.removeAttribute("disabled"),t.getElementsByClassName("button-text")[0].innerText=s}function n(t,e,n,a){let o=JSON.parse(t.dataset.status),l=t.dataset.trueText,i=t.dataset.falseText;n.status=!o,e.send(n,((e,n)=>{n&&e.success?(a(e),s(t,!1,e.status?l:i),t.dataset.status=JSON.stringify(e.status)):s(t,!1,"Failure")})),s(t,!0)}function a(t,e,s){let n=document.getElementsByClassName(t);for(let t of n)t.dataset.id===e&&(t.style.display=s?"inline-block":"none")}let o=function(e){let s={};for(let e of["set-admin","set-author"])s[e]=new t(e);return s}();document.body.onload=()=>{e("button-link",(t=>{window.location.assign(t.dataset.url)})),e("toggle-admin",(t=>{let e=t.dataset.username;n(t,o["set-admin"],{username:e},(t=>{a("is-admin",e,t.status)}))})),e("toggle-author",(t=>{let e=t.dataset.username;n(t,o["set-author"],{username:e},(t=>{a("is-author",e,t.status),t.reload_page&&window.location.replace(window.location.pathname+window.location.search+window.location.hash)}))})),function(){let t=document.getElementsByClassName("moment-from-now");for(let e of t){let t=moment.utc(e.dataset.time,"YYYY-MM-DD HH:mm:ss.SSS");e.innerText=t.fromNow()}}()}})();