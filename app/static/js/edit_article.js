(()=>{"use strict";class t{constructor(t){let e=document.getElementById(t);this.url=e.getAttribute("url"),this.csrf_token=e.getAttribute("csrf_token")}send(t,e,n=!0){let s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState){try{JSON.parse(s.responseText)}catch(t){return void e("failure",!1)}e(JSON.parse(s.responseText),200===s.status)}},s.open("POST",this.url,n),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("X-CSRFToken",this.csrf_token),s.send(JSON.stringify(t))}}function e(t,e){let n=document.getElementsByClassName(t);for(let t of n)t.addEventListener("click",(n=>{e(t)}))}function n(t,e,n="Loading..."){let s=t.getElementsByClassName("on-loads");for(let t of s)t.style.display=e?"inline-block":"none";e?t.setAttribute("disabled",""):t.removeAttribute("disabled"),t.getElementsByClassName("button-text")[0].innerText=n}function s(t,e,s,a){let o=JSON.parse(t.dataset.status),l=t.dataset.trueText,i=t.dataset.falseText;s.status=!o,e.send(s,((e,s)=>{s&&e.success?(a(e),n(t,!1,e.status?l:i),t.dataset.status=JSON.stringify(e.status)):n(t,!1,"Failure")})),n(t,!0)}let a=function(e){let n={};for(let e of["set-unlisted","set-author"])n[e]=new t(e);return n}();document.body.onload=()=>{e("button-link",(t=>{window.location.assign(t.dataset.url)})),e("toggle-unlisted",(t=>{let e=t.dataset.internal_name;s(t,a["set-unlisted"],{internal_name:e},(t=>{t.reload_page&&window.location.replace(window.location.pathname+window.location.search+window.location.hash)}))})),e("toggle-author",(t=>{let e=t.dataset.username,n=t.dataset.internal_name;s(t,a["set-author"],{username:e,internal_name:n},(t=>{!function(t,e,n){let s=document.getElementsByClassName("is-author");for(let t of s)t.dataset.id===e&&(t.style.display=n?"inline-block":"none")}(0,e,t.status)}))})),function(){let t=document.getElementsByClassName("moment-from-now");for(let e of t){let t=moment.utc(e.dataset.time,"YYYY-MM-DD HH:mm:ss.SSS");e.innerText=t.fromNow()}}()}})();