{% extends "base.html" %}

{% block content %}

<table class="table">
    {# head #}
    <thead>
        <tr>
            <th scope="col">name</th>
            <th scope="col">last seen</th>
            <th scope="col">options</th>
        </tr>
    </thead>
    {# body #}
    <tbody>
        {% for user in users %}
        <tr>
            <td>
                {{ user.username }}
                {% if user.is_admin %}ðŸ‘‘{% endif %}
            </td>

            <td>{{ moment(user.last_seen).fromNow() }}</td>

            <td>
                {# options table #}
                <table class="table">
                    <tr>
                        <th>
                            <a type="button" class="btn btn-warning"
                                href="{{ url_for('auth.change_password', username=user.username) }}">Change Password</a>
                        </th>
                        <th>
                            {% if not user.is_admin %}
                            <button type="button" class="btn btn-warning"
                                onclick="set_admin('{{ user.username }}', true);">Make Admin</button>
                            {% elif user != current_user %}
                            <button type="button" class="btn btn-danger"
                                onclick="set_admin('{{ user.username }}', false);">Revoke Admin
                                Privileges</button>
                            {% else %}
                            <button type="button" class="btn btn-outline-danger">Revoke Admin Privileges</button>
                            {% endif %}
                        </th>
                        <th>
                            {% if user.username != current_user.username %}
                            <a type="button" class="btn btn-danger"
                                href="{{ url_for('main.delete', username=user.username) }}">Delete User</a>
                            {% else %}
                            <a type="button" class="btn btn-outline-danger" href="#" disabled>Delete User</a>
                            {% endif %}
                        </th>
                    </tr>
                </table>
            </td>

        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}

{% block scripts %}
<ajax_url id="set_admin_ajax" url="{{ url_for('set_admin')" />
<script src="{{ url_for('static', filename='js/users.js') }}"></script>
{% endblock %}
